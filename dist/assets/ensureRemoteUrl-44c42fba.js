async function u(o){const i=(o==null?void 0:o.remoteUrl)||(o==null?void 0:o.url)||(o==null?void 0:o.blobUrl);if(i!=null&&i.startsWith("https://"))return i;const r=await(await fetch("/.netlify/functions/cloudinary-sign",{method:"POST"})).json();if(!(r!=null&&r.signature))throw new Error("Cloudinary sign failed");const l=o!=null&&o.file?o.file:await(await fetch(i)).blob(),n=new FormData;n.append("file",l),r.folder&&n.append("folder",r.folder),n.append("timestamp",String(r.timestamp)),n.append("api_key",r.apiKey),n.append("signature",r.signature);const t=await fetch(`https://api.cloudinary.com/v1_1/${r.cloudName}/auto/upload`,{method:"POST",body:n}),e=await t.json();if(!t.ok||!(e!=null&&e.secure_url))throw new Error("Upload failed");return e.secure_url}export{u as ensureRemoteUrl};
