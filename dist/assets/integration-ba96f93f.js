import{a as c,O as r,i as l}from"./index-6f5177cc.js";const d={i2i:"eagle",txt2img:"flux",restore:"eagle",story:"eagle"};function g({preset:e,src:o}){return{model:e.model??d[e.mode],mode:e.mode,inputType:e.input,prompt:e.prompt,negative:e.negative_prompt,strength:e.strength??.6,sourceUrl:o,post:e.post,meta:{presetId:e.id,label:e.label}}}function m(){return null}async function y(e){return console.log("🚀 Calling AIML API with payload:",e),{success:!0,resultUrl:"mock-result-url"}}async function f(e){return console.log("💾 Saving media to DB and Cloudinary:",e),{id:"mock-record-id",url:e.resultUrl}}function w(e){console.log("🎉 Adding result to UI:",e),window.dispatchEvent(new CustomEvent("generation-complete",{detail:{record:e,resultUrl:e.url,timestamp:Date.now()}}))}function s(e,o){console.log(`${e==="success"?"✅":"❌"} Toast: ${o}`),window.dispatchEvent(new CustomEvent(`generation-${e}`,{detail:{message:o,timestamp:Date.now()}}))}async function u(e){try{console.log("🎯 Running preset:",e.label);const o=e.requiresSource?m():null;if(e.requiresSource&&!o){s("error","Pick a photo/video first, then apply a preset.");return}const n=g({preset:e,src:o});console.log("📦 Built payload:",n);const t=await y(n);if(!t.success)throw new Error("Generation failed");const i=await f(t);w(i),s("success",`${e.label} applied!`)}catch(o){console.error("❌ Preset execution failed:",o),s("error","Generation failed. Please try again.")}}async function h(e){try{const o=c(e);await u(o)}catch(o){console.error("❌ Preset click failed:",o),s("error",`Failed to apply ${e}. Please try again.`)}}async function a(e,o){var n;try{const t=(n=r[e])==null?void 0:n[o];if(!t){console.warn(`Option ${e}/${o} not configured`),s("error","Coming soon!");return}const i=c(t.use,t.overrides);console.log(`🔧 Resolved option ${e}/${o} to preset:`,i.label),await u(i)}catch(t){console.error(`❌ Option click failed for ${e}/${o}:`,t),s("error","Generation failed. Please try again.")}}async function k(e,o,n){if(console.log("🕰️ Time machine click:",e),l("time_machine",e)){console.log("✅ Using new preset system for:",e),await a("time_machine",e);return}console.warn("⚠️ Option not configured in new system, falling back:",e),window.dispatchEvent(new CustomEvent("generation-error",{detail:{message:`${e} is not configured yet`,timestamp:Date.now()}}))}async function O(e){if(console.log("🔧 Restore click:",e),l("restore",e)){console.log("✅ Using new preset system for:",e),await a("restore",e);return}console.warn("⚠️ Restore option not configured:",e),window.dispatchEvent(new CustomEvent("generation-error",{detail:{message:`${e} restore is not configured yet`,timestamp:Date.now()}}))}async function b(e){if(console.log("📖 Story click:",e),l("story",e)){console.log("✅ Using new preset system for:",e),await a("story",e);return}console.warn("⚠️ Story option not configured:",e),window.dispatchEvent(new CustomEvent("generation-error",{detail:{message:`${e} story mode is not configured yet`,timestamp:Date.now()}}))}async function P(e,o,n){console.log("🎨 Preset click (integrated):",e),await h(e)}function p(){const e=Object.keys(r.time_machine||{}),o=Object.keys(r.restore||{}),n=Object.keys(r.story||{});return{time_machine:e,restore:o,story:n,total:e.length+o.length+n.length}}function C(){console.group("🔍 Preset System Debug"),console.log("Available options:",p()),console.log("Time machine options:",Object.keys(r.time_machine||{})),console.log("Restore options:",Object.keys(r.restore||{})),console.log("Story options:",Object.keys(r.story||{})),console.groupEnd()}export{C as debugPresetSystem,p as getAvailableOptions,P as onPresetClickIntegrated,O as onRestoreClick,b as onStoryClick,k as onTimeMachineClick};
