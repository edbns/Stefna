{
  "version": 3,
  "sources": ["../../../../../../Users/sennie/Desktop/Stefna-main/netlify/functions/publish-asset.ts", "../../../../../../Users/sennie/Desktop/Stefna-main/netlify/lib/supabaseAdmin.ts"],
  "sourceRoot": "/var/folders/3j/nmp5dkpd4tv8j0yq8f2ln8780000gn/T/tmp-42344-FE62UM1ejJUT",
  "sourcesContent": ["import { Handler } from '@netlify/functions';\nimport { supabaseAdmin } from '../lib/supabaseAdmin';\nimport type { PublishAssetInput, ApiResult } from '../../src/lib/types';\n\nexport const handler: Handler = async (event) => {\n  try {\n    const input = JSON.parse(event.body || '{}') as PublishAssetInput;\n    if (!input.assetId) return resp({ ok: false, error: 'assetId required' });\n\n    const { data, error } = await supabaseAdmin\n      .from('assets')\n      .update({\n        is_public: input.isPublic,\n        allow_remix: input.allowRemix,\n      })\n      .eq('id', input.assetId)\n      .select('*')\n      .single();\n\n    if (error) return resp({ ok: false, error: error.message });\n\n    // DB trigger sets published_at when public+ready.\n    return resp({ ok: true, data });\n  } catch (e: any) {\n    return resp({ ok: false, error: e.message || 'publish-asset error' });\n  }\n};\n\nfunction resp(body: ApiResult<any>) {\n  return { statusCode: body.ok ? 200 : 400, body: JSON.stringify(body) };\n}\n", "import { createClient } from '@supabase/supabase-js';\n\nexport const supabaseAdmin = createClient(\n  process.env.SUPABASE_URL!,\n  process.env.SUPABASE_SERVICE_ROLE_KEY!,\n  { auth: { persistSession: false } }\n);\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;;;ACAA,yBAA6B;AAEtB,IAAM,oBAAgB;AAAA,EAC3B,QAAQ,IAAI;AAAA,EACZ,QAAQ,IAAI;AAAA,EACZ,EAAE,MAAM,EAAE,gBAAgB,MAAM,EAAE;AACpC;;;ADFO,IAAM,UAAmB,OAAO,UAAU;AAC/C,MAAI;AACF,UAAM,QAAQ,KAAK,MAAM,MAAM,QAAQ,IAAI;AAC3C,QAAI,CAAC,MAAM,QAAS,QAAO,KAAK,EAAE,IAAI,OAAO,OAAO,mBAAmB,CAAC;AAExE,UAAM,EAAE,MAAM,MAAM,IAAI,MAAM,cAC3B,KAAK,QAAQ,EACb,OAAO;AAAA,MACN,WAAW,MAAM;AAAA,MACjB,aAAa,MAAM;AAAA,IACrB,CAAC,EACA,GAAG,MAAM,MAAM,OAAO,EACtB,OAAO,GAAG,EACV,OAAO;AAEV,QAAI,MAAO,QAAO,KAAK,EAAE,IAAI,OAAO,OAAO,MAAM,QAAQ,CAAC;AAG1D,WAAO,KAAK,EAAE,IAAI,MAAM,KAAK,CAAC;AAAA,EAChC,SAAS,GAAQ;AACf,WAAO,KAAK,EAAE,IAAI,OAAO,OAAO,EAAE,WAAW,sBAAsB,CAAC;AAAA,EACtE;AACF;AAEA,SAAS,KAAK,MAAsB;AAClC,SAAO,EAAE,YAAY,KAAK,KAAK,MAAM,KAAK,MAAM,KAAK,UAAU,IAAI,EAAE;AACvE;",
  "names": []
}
