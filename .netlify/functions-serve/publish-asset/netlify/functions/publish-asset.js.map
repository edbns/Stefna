{
  "version": 3,
  "sources": ["../../../../../../Users/sennie/Desktop/Stefna-main/netlify/functions/publish-asset.ts", "../../../../../../Users/sennie/Desktop/Stefna-main/netlify/lib/neonAdmin.ts"],
  "sourceRoot": "/var/folders/3j/nmp5dkpd4tv8j0yq8f2ln8780000gn/T/tmp-5584-QOpkIRJpzlfh",
  "sourcesContent": ["import { Handler } from '@netlify/functions';\nimport { neonAdmin } from '../lib/neonAdmin';\nimport type { PublishAssetInput, ApiResult } from '../../src/lib/types';\n\nexport const handler: Handler = async (event) => {\n  try {\n    const input = JSON.parse(event.body || '{}') as PublishAssetInput;\n    if (!input.assetId) return resp({ ok: false, error: 'assetId required' });\n\n    const { data, error } = await neonAdmin\n      .from('assets')\n      .update({\n        is_public: input.isPublic,\n        allow_remix: input.allowRemix,\n      })\n      .eq('id', input.assetId)\n      .select('*')\n      .single();\n\n    if (error) return resp({ ok: false, error: error.message });\n\n    // DB trigger sets published_at when public+ready.\n    return resp({ ok: true, data });\n  } catch (e: any) {\n    return resp({ ok: false, error: e.message || 'publish-asset error' });\n  }\n};\n\nfunction resp(body: ApiResult<any>) {\n  return { statusCode: body.ok ? 200 : 400, body: JSON.stringify(body) };\n}\n", "// Neon-compatible admin client - replaces Supabase admin\nimport { sql } from '@neondatabase/serverless';\n\n// Mock Neon admin client interface for backward compatibility\nexport const neonAdmin = {\n  from: (table: string) => {\n    console.warn(`neonAdmin.from('${table}') is deprecated. Use Neon sql directly instead.`);\n    return {\n      select: () => ({ eq: () => ({ single: () => ({ data: null, error: null }) }) }),\n      insert: () => ({ select: () => ({ single: () => ({ data: null, error: null }) }) }),\n      update: () => ({ eq: () => ({ select: () => ({ single: () => ({ data: null, error: null }) }) }) }),\n      delete: () => ({ eq: () => ({ data: null, error: null }) })\n    };\n  }\n};\n\n// Legacy export for backward compatibility\nexport const supabaseAdmin = neonAdmin;\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;;;ACIO,IAAM,YAAY;AAAA,EACvB,MAAM,CAAC,UAAkB;AACvB,YAAQ,KAAK,mBAAmB,KAAK,kDAAkD;AACvF,WAAO;AAAA,MACL,QAAQ,OAAO,EAAE,IAAI,OAAO,EAAE,QAAQ,OAAO,EAAE,MAAM,MAAM,OAAO,KAAK,GAAG,GAAG;AAAA,MAC7E,QAAQ,OAAO,EAAE,QAAQ,OAAO,EAAE,QAAQ,OAAO,EAAE,MAAM,MAAM,OAAO,KAAK,GAAG,GAAG;AAAA,MACjF,QAAQ,OAAO,EAAE,IAAI,OAAO,EAAE,QAAQ,OAAO,EAAE,QAAQ,OAAO,EAAE,MAAM,MAAM,OAAO,KAAK,GAAG,GAAG,GAAG;AAAA,MACjG,QAAQ,OAAO,EAAE,IAAI,OAAO,EAAE,MAAM,MAAM,OAAO,KAAK,GAAG;AAAA,IAC3D;AAAA,EACF;AACF;;;ADVO,IAAM,UAAmB,OAAO,UAAU;AAC/C,MAAI;AACF,UAAM,QAAQ,KAAK,MAAM,MAAM,QAAQ,IAAI;AAC3C,QAAI,CAAC,MAAM,QAAS,QAAO,KAAK,EAAE,IAAI,OAAO,OAAO,mBAAmB,CAAC;AAExE,UAAM,EAAE,MAAM,MAAM,IAAI,MAAM,UAC3B,KAAK,QAAQ,EACb,OAAO;AAAA,MACN,WAAW,MAAM;AAAA,MACjB,aAAa,MAAM;AAAA,IACrB,CAAC,EACA,GAAG,MAAM,MAAM,OAAO,EACtB,OAAO,GAAG,EACV,OAAO;AAEV,QAAI,MAAO,QAAO,KAAK,EAAE,IAAI,OAAO,OAAO,MAAM,QAAQ,CAAC;AAG1D,WAAO,KAAK,EAAE,IAAI,MAAM,KAAK,CAAC;AAAA,EAChC,SAAS,GAAQ;AACf,WAAO,KAAK,EAAE,IAAI,OAAO,OAAO,EAAE,WAAW,sBAAsB,CAAC;AAAA,EACtE;AACF;AAEA,SAAS,KAAK,MAAsB;AAClC,SAAO,EAAE,YAAY,KAAK,KAAK,MAAM,KAAK,MAAM,KAAK,UAAU,IAAI,EAAE;AACvE;",
  "names": []
}
